---
sidebar_position: 7
sidebar_label: Using the JavaScript SDK with TanStack Query
title: Using the Native JavaScript SDK with TanStack Query | Tutorials
description: In this tutorial, you will learn how to query the SurrealDB RESTful HTTP API endpoints using Postman.
---

# How to Use SurrealDB with Tanstack Query

This tutorial will guide you through the steps to integrate SurrealDB with a React application using Tanstack Query (formerly React Query). We'll cover setting up the database, fetching data, and displaying it in a React component.

## Prerequisites

- Node.js and npm installed
- Basic knowledge of React and TypeScript
- SurrealDB installed

## Step 1: Setting Up SurrealDB

First, ensure that SurrealDB is installed and running.

```yaml
surreal start --user root --pass root
```

## Step 2: Create the React Application

Create a new React application using Create React App with TypeScript. In this example we use Vite.

```yaml
npm create vite@latest surrealdb-query --template react-ts
cd surrealdb-query
```

## Step 3: Install Dependencies

Install Tanstack Query (React Query) and SurrealDB client.

```yaml
npm install @tanstack/react-query surrealdb.js
```

## Step 4: Set Up Tanstack Query in Your React Application

#### Initialize the Database

Create a file named db.ts and add the following code to connect to SurrealDB and initialize the database with sample data.

```yaml
import Surreal from 'surrealdb.js';

let db: Surreal | undefined;

export async function initDb(): Promise<Surreal | undefined> {
    if (db) return db;
    db = new Surreal();
    try {
        await db.connect("http://127.0.0.1:8000/rpc");
        await db.use({ namespace: "test", database: "test" });
        await db.signin({ username: 'root', password: 'root' })

        await db.query(`
            CREATE post CONTENT {
              title: 'Hello from SurrealDB',
              content: 'This is a hello from SurrealDB'
            };
            CREATE post CONTENT {
              title: 'SurrealDB is Awesome',
              content: 'This is a post about SurrealDB'
            };
        `);

        return db;
    } catch (err) {
        console.error("Failed to connect to SurrealDB:", err);
        throw err;
    }
}

interface Post {
  id: string;
  title: string;
  content: string;
}

export const getAllPosts = async (): Promise<Post[]> => {
    const posts = await db?.select('post');
    if (!posts) {
        throw new Error("Failed to fetch posts");
    }
    return posts.map(post => ({
        id: post.id as unknown as string,
        title: post.title as string,
        content: post.content as string,
    })) as Post[];
};

```

#### Create the main application file Main.tsx and add the following code.

```yaml
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.tsx'
import './index.css'
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'

const queryClient = new QueryClient()

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <QueryClientProvider client={queryClient}>
      <App />
      <ReactQueryDevtools />
    </QueryClientProvider>
  </React.StrictMode>,
)
```

#### Then create the application file App.tsx and add the following code to fetch and display posts.

```yaml
import React from 'react';
import { useQuery } from '@tanstack/react-query';
import { initDb, getAllPosts } from './db';

interface Post {
  id: string;
  title: string;
  content: string;
}

const fetchAllPosts = async (): Promise<Post[]> => {
  await initDb();
  const posts = await getAllPosts();
  if (!posts || posts.length === 0) {
    throw new Error('No posts found');
  }
  return posts;
};

const fetchPostByTitle = async (title: string): Promise<Post> => {
  await initDb();
  const posts = await getAllPosts();
  const post = posts.find(p => p.title === title);
  if (!post) {
    throw new Error(`No post found with title ${title}`);
  }
  return post;
};

const App: React.FC = () => {
  const { data: posts, isLoading: isLoadingPosts, error: postsError } = useQuery<Post[]>({
    queryKey: ['posts'],
    queryFn: fetchAllPosts,
  });

  const { data: post, isLoading: isLoadingPost, error: postError } = useQuery<Post>({
    queryKey: ['postByTitle', 'Hello from SurrealDB'],
    queryFn: () => fetchPostByTitle('Hello from SurrealDB'),
  });

  if (isLoadingPosts || isLoadingPost) return <div>Loading...</div>;
  if (postsError) return <div>Error loading posts: {postsError.message}</div>;
  if (postError) return <div>Error loading post: {postError.message}</div>;

  return (
    <div>
      <h1>Fetching All Posts</h1>
      <ul>
        {posts?.map(post => (
          <li key={post.id}>
            <h2>{post.title}</h2>
            <p>{post.content}</p>
          </li>
        ))}
      </ul>

      <h1>Post by Title</h1>
      {post && (
        <div>
          <h2>{post.title}</h2>
          <p>{post.content}</p>
        </div>
      )}
    </div>
  );
};

export default App;
```

### Step 5: Run the React Application

Start the React application:

```yaml
npm start
```

Lastly, open your browser and go to the following url:

```yaml
http://localhost:5173/
```
You should see something like the following:

<img src="/docs/img/surrealdb-query-browser-screenshot.jpg" alt="query screenshot" width="1528" />

#### Open Surrealist app the see the newly created database records.

<img src="/docs/img/surrealist-tanstack-query.jpg" alt="surrealist screenshot" width="1505" />


## Conclusion
You have successfully set up a React application using TypeScript and Tanstack Query to fetch data directly from SurrealDB. This tutorial demonstrates how to initialize the database, fetch data, and display it in a React component.