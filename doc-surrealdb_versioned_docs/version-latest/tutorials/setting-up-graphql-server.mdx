---
sidebar_position: 7
sidebar_label: Setting up a GraphQL Server with SurrealDB
title: Setting up a GraphQL Server with SurrealDB
description: In this tutorial, you will learn how to set up and use the official GitHub Action for SurrealDB in your CI/CD pipeline.
---

### Introduction

In this tutorial, we will guide you through setting up a GraphQL server with SurrealDB as the database. By the end of this tutorial, you will have a running GraphQL API that allows you to query posts by their ID.

### Prerequisites

- Node.js installed on your machine
- SurrealDB installed and running
- Basic knowledge of JavaScript and GraphQL

### Step 1: Install Node.js and SurrealDB

Ensure you have Node.js and SurrealDB installed on your machine. You can download Node.js from [Node.js website](https://nodejs.org/) and follow the instructions on the [SurrealDB website](https://surrealdb.com/install) to install SurrealDB.

### Step 2: Create a New Project

1. Open your terminal and create a new directory for your project:
   ```yaml
   mkdir graphql-surrealdb
   cd graphql-surrealdb
   ```

2. Initialize a new Project (in this example we use pnpm, but feel free to use any bundler, like npm, yarn or bun)
   ```yaml
   pnpm init
   ```

3. Install the necessary packages:
   ```yaml
   pnpm install express express-graphql graphql surrealdb.js
   ```

### Step 3: Set Up the Database Utility
Create a file named db.js to initialize SurrealDB and define your operations.

   ```js
   import Surreal from 'surrealdb.js';

   const db = new Surreal();

   const initDB = async () => {
   await db.connect('http://127.0.0.1:8000/rpc');
   await db.use({ namespace: "test", database: "test" });

   await db.query(`
      CREATE post CONTENT {
         title: 'Hello from SurrealDB',
         content: 'This is a hello from SurrealDB'
      };
      CREATE post CONTENT {
         title: 'SurrealDB is Awesome',
         content: 'This is a post about SurrealDB'
      };
   `);
   };

   const getPostById = async (id) => {
      const post = await db.select(`post:${id}`);
      return post[0];
   };

   const getAllPosts = async () => {
      return await db.select('post');
   };

   export { initDB, getPostById, getAllPosts };
   ```

### Step 4: Set Up the GraphQL Server

   Create a file named server.js and add the following code:

   ```js
   import express from 'express';
   import { graphqlHTTP } from 'express-graphql';
   import { buildSchema } from 'graphql';
   import { initDB, getPostById, getAllPosts } from './db.js';

   const schema = buildSchema(`
      type Query {
         post(id: ID!): Post
         posts: [Post]
      }

      type Post {
         id: ID
         title: String
         content: String
      }
   `);

   const root = {
      post: async ({ id }) => {
         return await getPostById(id);
      },
      posts: async () => {
         return await getAllPosts();
      }
   };

   const app = express();
      app.use('/graphql', graphqlHTTP({
      schema: schema,
      rootValue: root,
      graphiql: true,
   }));

   initDB().then(() => {
      app.listen(4000, () => console.log('Serving from localhost:4000/graphql'));
   }).catch(err => {
      console.error('Failed to initialize the database:', err);
   });
   ```

### Step 5. Run SurrealDB

Start SurrealDB in your terminal:

```yaml
surreal start --user root --pass root
```

### Step 6: Run the GraphQL Server

Start the GraphQL server in another terminal:

```yaml
pnpm start
```

### Step 7: Access GraphiQL Interface

Open your browser and navigate to http://localhost:4000/graphql. You should see the GraphiQL interface.

### Step 8: Query the API

Query All Posts

Use the following query to fetch all the posts:

```yaml
{
  posts {
    id
    title
    content
  }
}
```

You should see something like this:
<img src="/docs/img/graphql_screenshot.jpg" alt="graphql screenshot" width="1013" />


Open Surrealist to see the records listed in your query. You should see something like the following:

<img src="/docs/img/surrealist_screenshot.jpg" alt="graphql screenshot" width="1013" />

### Conclusion

You have successfully set up a GraphQL server with SurrealDB. You can now extend this setup with more features and functionalities as per your requirements. If you have any questions or face any issues, please feel free to reach out.