---
sidebar_position: 1
sidebar_label: React
title: React | Frameworks
description: The SurrealDB SDK for JavaScript enables simple and advanced querying of a remote or embedded database.
---

# Tanstack Query

### Why Tanstack Query

At SurrealDB, we prefer Tanstack Query because it is a simple yet powerful asynchronous state management solution. We appreciate that it comes with zero dependencies, automatic caching, and data synchronization, but what we value most is how it allows developers to focus more on building features and less on managing complex state logic.


## How to Use SurrealDB with Tanstack Query

This tutorial will guide you through the steps to integrate SurrealDB with a React application using Tanstack Query (formerly React Query). We'll cover setting up the database, fetching data, and displaying it in a React component.

### Prerequisites

- Node.js and npm installed
- Basic knowledge of React and TypeScript
- SurrealDB installed

### Install the SDK

First, install the SurrealDB SDK using your favorite package manager:

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

<Tabs groupId="node-package-manager">
  <TabItem value="npm" label="npm" default>

```bash
npm install --save surrealdb.js
```

  </TabItem>
  <TabItem value="yarn" label="yarn">

```bash
yarn add surrealdb.js
```

  </TabItem>
  <TabItem value="pnpm" label="pnpm">

```bash
pnpm install surrealdb.js
```

  </TabItem>
  <TabItem value="bun" label="bun">

```bash
bun install surrealdb.js
```

  </TabItem>
</Tabs>

<br />

### Install Tanstack Query

Install Tanstack Query (React Query) and SurrealDB client.

<Tabs groupId="node-package-manager">
  <TabItem value="npm" label="npm" default>

```bash
npm i @tanstack/react-query
```

  </TabItem>
  <TabItem value="yarn" label="yarn">

```bash
yarn add @tanstack/react-query
```

  </TabItem>
  <TabItem value="pnpm" label="pnpm">

```bash
pnpm add @tanstack/react-query
```

  </TabItem>
  <TabItem value="bun" label="bun">

```bash
bun add @tanstack/react-query
```

  </TabItem>
</Tabs>

### Import the SDK to your project

After installing, you can then import the SDK into your project. Depending on your setup and environment, we supported multiple options. 

:::note
__Note:__ It is recommended to import this in a utility file or a file that is shared across your application.
:::

```bash title="CommonJS"
const { Surreal } = require('surrealdb.js');
```

```bash title="ES6"
import { Surreal } from 'surrealdb.js';
```

Importing via a CDN is also supported:

```bash title="CDN"
import Surreal from "https://unpkg.com/surrealdb.js";
// or
import Surreal from "https://cdn.jsdelivr.net/npm/surrealdb.js";
```

### Initialize the SDK

The SDK's initialization may vary depending on your environment. 

{/* Follow the recommended steps in the initialization section of your framework. */}

- [JavaScript or TypeScript](/docs/sdk/javascript/core/initialization)

## Start SurrealDB

First, ensure that SurrealDB is installed and running and then run the folowing:

```yaml
surreal start --user root --pass root
```

## Create the React Application

Create a new React application using Create React App with TypeScript. In this example we use Vite.

```yaml
npm create vite@latest surrealdb-query --template react-ts
cd surrealdb-query
```

## Set Up Tanstack Query in Your React Application

#### Initialize the Database

Create a file named db.ts and add the following code to connect to SurrealDB and initialize the database with sample data.

```yaml
import Surreal from 'surrealdb.js';

let db: Surreal | undefined;

export async function initDb(): Promise<Surreal | undefined> {
    if (db) return db;
    db = new Surreal();
    
    await db.connect("http://127.0.0.1:8000/rpc")
        .catch(err => { console.error("Failed to connect to SurrealDB:", err); throw err; });

    await db.use({ namespace: "test", database: "test" })
        .catch(err => { console.error("Failed to select namespace and database:", err); throw err; });

    await db.signin({ username: 'root', password: 'root' })
        .catch(err => { console.error("Failed to sign in to SurrealDB:", err); throw err; });

    await db.query(`
            CREATE post CONTENT {
              title: 'Hello from SurrealDB',
              content: 'This is a hello from SurrealDB'
            };
            CREATE post CONTENT {
              title: 'SurrealDB is Awesome',
              content: 'This is a post about SurrealDB'
            };
        `)
        .catch(err => { console.error("Failed to execute query in SurrealDB:", err); throw err; });

    return db;
}

interface Post {
  id: string;
  title: string;
  content: string;
}

export const getAllPosts = async (): Promise<Post[]> => {
    const posts = await db?.select('post');
    if (!posts) {
        throw new Error("Failed to fetch posts");
    }
    return posts.map(post => ({
        id: post.id as string,
        title: post.title as string,
        content: post.content as string,
    })) as Post[];
};

```

We sign in to SurrealDB using the root credentials. This step is necessary for authentication and authorization, allowing us to perform operations in the database.
we execute a query that creates two initial posts in the database. Using the query method, we pass a raw SQL-like string to define the posts. The withErrorHandling function ensures that any errors during query execution are caught and handled consistently. 
Initializing your database with some data is useful for testing and ensuring that the setup works as expected.
Finally, we return the initialized db instance. This allows other parts of your application to access the database connection. 
Returning the instance after successful initialization is crucial for ensuring that subsequent database operations can be performed.

#### Create the main application file Main.tsx and add the following code.

```yaml
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.tsx'
import './index.css'
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'

const queryClient = new QueryClient()

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <QueryClientProvider client={queryClient}>
      <App />
    </QueryClientProvider>
  </React.StrictMode>,
)
```
This block imports necessary modules and components for setting up your React application, such as React and ReactDOM, the main component of your application, where you define the overall UI and logic and lastly 
QueryClient and QueryClientProvider, imported from Tanstack Query, these are essential for managing and providing the query client that enables data fetching and caching throughout your application.
<p>
By wrapping your App component with <b>QueryClientProvider</b>, you ensure that every component within App can access and leverage Tanstack Query for fetching, caching, and synchronizing server state.
</p>
#### Then create the application file App.tsx and add the following code to fetch and display posts.

```yaml
import React from 'react';
import { useQuery } from '@tanstack/react-query';
import { initDb, getAllPosts } from './db';

interface Post {
  id: string;
  title: string;
  content: string;
}

const fetchAllPosts = async (): Promise<Post[]> => {
  await initDb();
  const posts = await getAllPosts();
  if (!posts || posts.length === 0) {
    throw new Error('No posts found');
  }
  return posts;
};

const fetchPostByTitle = async (title: string): Promise<Post> => {
  await initDb();
  const posts = await getAllPosts();
  const post = posts.find(p => p.title === title);
  if (!post) {
    throw new Error(`No post found with title ${title}`);
  }
  return post;
};

const App: React.FC = () => {
  const { data: posts, isLoading: isLoadingPosts, error: postsError } = useQuery<Post[]>({
    queryKey: ['posts'],
    queryFn: fetchAllPosts,
  });

  const { data: post, isLoading: isLoadingPost, error: postError } = useQuery<Post>({
    queryKey: ['postByTitle', 'Hello from SurrealDB'],
    queryFn: () => fetchPostByTitle('Hello from SurrealDB'),
  });

  if (isLoadingPosts || isLoadingPost) return <div>Loading...</div>;
  if (postsError) return <div>Error loading posts: {postsError.message}</div>;
  if (postError) return <div>Error loading post: {postError.message}</div>;

  return (
    <div>
      <h1>Fetching All Posts</h1>
      <ul>
        {posts?.map(post => (
          <li key={post.id}>
            <h2>{post.title}</h2>
            <p>{post.content}</p>
          </li>
        ))}
      </ul>

      <h1>Post by Title</h1>
      {post && (
        <div>
          <h2>{post.title}</h2>
          <p>{post.content}</p>
        </div>
      )}
    </div>
  );
};

export default App;
```


The function fetchAllPosts, initializes the database and fetches all posts. 
It checks if posts are available and throws an error if none are found. 
This function is designed to be used with Tanstack Query to handle data fetching efficiently, leveraging React's state management for asynchronous operations.

<p>
In the useQuery hook, we configure Tanstack Query to fetch all posts using the fetchAllPosts function. 
The queryKey is used to uniquely identify this query. staleTime is set to 5 minutes, meaning the data will be considered fresh for that period. 
This reduces unnecessary re-fetching and enhances performance by caching the data. 
The useQuery hook also provides isLoading and error states, which are useful for handling loading indicators and errors in the UI.
</p>
### Run the React Application

Start the React application:

<Tabs groupId="node-package-manager">
  <TabItem value="npm" label="npm" default>

```bash
npm start
```

  </TabItem>
  <TabItem value="yarn" label="yarn">

```bash
yarn start
```

  </TabItem>
  <TabItem value="pnpm" label="pnpm">

```bash
pnpm start
```

  </TabItem>
  <TabItem value="bun" label="bun">

```bash
bun start
```

  </TabItem>
</Tabs>

Lastly, open your browser and go to the following url:

```yaml
http://localhost:5173/
```

#### Open Surrealist app and you should see the newly created database records.

<img src="/docs/img/surrealist-tanstack-query.jpg" alt="surrealist screenshot" width="1505" />


## Conclusion
You have successfully set up a React application using TypeScript and Tanstack Query to fetch data directly from SurrealDB. This tutorial demonstrates how to initialize the database, fetch data, and display it in a React component.
